!function(i,n){"use strict";if(i&&i.customize){var s=i.customize;s.SFGuidedTourSteps=[],"undefined"!=typeof _wpCustomizeSFGuidedTourSteps&&n.extend(s.SFGuidedTourSteps,_wpCustomizeSFGuidedTourSteps),s.SFGuidedTour={$container:null,currentStep:-1,init:function(){this._setupUI()},_setupUI:function(){var t=this,e=n("body.wp-customizer .wp-full-overlay");this.$container=n("<div/>").addClass("woostify-guided-tour"),e.prepend(this.$container),this._addListeners(),this.$container.css("left",n("#customize-controls").width()+10+"px").on("transitionend",function(){t.$container.addClass("woostify-loaded")}),this._showNextStep(),n(document).on("click",".woostify-guided-tour-step .woostify-nux-button",function(){return t._showNextStep(),!1}),n(document).on("click",".woostify-guided-tour-step .woostify-guided-tour-skip",function(){return 0===t.currentStep?t._hideTour(!0):t._showNextStep(),!1})},_addListeners:function(){var t=this;s.state("expandedSection").bind(function(){t._adjustPosition()}),s.state("expandedPanel").bind(function(){t._adjustPosition()})},_adjustPosition:function(){var t=this._getCurrentStep(),e=s.state("expandedSection").get(),i=s.state("expandedPanel").get();if(t)if(this.$container.removeClass("woostify-inside-section"),e&&t.section===e.id)this._moveContainer(n(e.container[1]).find(".customize-section-title")),this.$container.addClass("woostify-inside-section");else if(!1===e&&!1===i)if(this._isTourHidden())this._revealTour();else{var o=this._getSelector(t.section);this._moveContainer(o)}else this._hideTour()},_hideTour:function(t){var e=this;this._isTourHidden()||(this.$container.css({transform:"",top:this.$container.offset().top}),n(document.body).addClass("woostify-exiting").on("animationend.woostify webkitAnimationEnd.woostify",function(){n(this).removeClass("woostify-exiting").off("animationend.woostify webkitAnimationEnd.woostify").addClass("woostify-hidden"),e.$container.hide(),_.isUndefined(t)||!0!==t||e._removeTour()}))},_revealTour:function(){var t=this;n(document.body).removeClass("woostify-hidden"),t.$container.show(),n(document.body).addClass("woostify-entering").on("animationend.woostify webkitAnimationEnd.woostify",function(){n(this).removeClass("woostify-entering").off("animationend.woostify webkitAnimationEnd.woostify"),t.$container.css({top:"auto",transform:"translateY("+parseInt(t.$container.offset().top,10)+"px)"})})},_removeTour:function(){this.$container.remove()},_closeAllSections:function(){s.section.each(function(t){t.collapse({duration:0})}),s.panel.each(function(t){t.collapse({duration:0})})},_showNextStep:function(){var t,e;this._isLastStep()?this._hideTour(!0):(this._closeAllSections(),(t=this._getNextStep()).message=this._lineBreaksToParagraphs(t.message),e=i.template("woostify-guided-tour-step"),this.$container.removeClass("woostify-first-step"),0===this.currentStep&&(t.first_step=!0,this.$container.addClass("woostify-first-step")),this._isLastStep()&&(t.last_step=!0,this.$container.addClass("woostify-last-step")),this._moveContainer(this._getSelector(t.section)),this.$container.html(e(t)))},_moveContainer:function(t){var e,i=this;t&&(e=parseInt(t.offset().top,10)+t.height()/2-44,this.$container.addClass("woostify-moving").css({transform:"translateY("+parseInt(e,10)+"px)"}).on("transitionend.woostify",function(){i.$container.removeClass("woostify-moving"),i.$container.off("transitionend.woostify")}))},_getSelector:function(t){var e=s.section(t)?s.section(t):s.panel(t);return _.isUndefined(e)?n(t):n(e.container[0])},_getCurrentStep:function(){return s.SFGuidedTourSteps[this.currentStep]},_getNextStep:function(){return this.currentStep=this.currentStep+1,s.SFGuidedTourSteps[this.currentStep]},_isTourHidden:function(){return!!n(document.body).hasClass("woostify-hidden")},_isLastStep:function(){return!(this.currentStep+1<s.SFGuidedTourSteps.length)},_lineBreaksToParagraphs:function(t){return"<p>"+t.replace("\n\n","</p><p>")+"</p>"}},n(document).ready(function(){s.SFGuidedTour.init()})}}(window.wp,jQuery);